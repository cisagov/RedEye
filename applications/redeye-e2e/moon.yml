dependsOn:
  - 'server'
  - 'client'

tasks:
  start:
    local: true
    command:
      - cypress
      - open
      - --config-file
      - cypress.config.js
    env:
      CYPRESS_BASE_URL: http://localhost:3500
    options:
      runInCI: false

  run:
    local: true
    command:
      - cypress
      - run
      - --config-file
      - cypress.config.js
    env:
      CYPRESS_BASE_URL: http://localhost:3500
    platform: node
    options:
      runInCI: false

  # open-cy:
  #   command: 'concurrently "yarn start:client" "yarn start:server" "yarn moon run redeye-e2e:start-cypress"'
  #   local: true
  #   options:
  #     runFromWorkspaceRoot: true

  open-cy:
    command: 'noop'
    deps:
      - 'client:start-dev'
      - 'server:start-dev'
      - 'redeye-e2e:start'
    local: true

  open-cy-blue:
    command: 'noop'
    deps:
      - 'client:start-dev'
      - 'server:start-blue'
      - 'redeye-e2e:start'
    options:
      runDepsInParallel: false
      cache: false
    local: true
    env:
      SERVER_BLUE_TEAM: 'true'
